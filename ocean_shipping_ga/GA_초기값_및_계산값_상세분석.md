# ğŸ§¬ GA ì•Œê³ ë¦¬ì¦˜ ì´ˆê¸°ê°’ ë° ê³„ì‚°ê°’ ìƒì„¸ ë¶„ì„

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” í•´ìƒ ìš´ì†¡ GA ìµœì í™” ì‹œìŠ¤í…œì˜ ì´ˆê¸°ê°’ ì„¤ì •ê³¼ ì‹¤ì œ ê³„ì‚°ê°’ì— ëŒ€í•œ ìƒì„¸í•œ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ê°’ì€ ì¶”ì •ì´ ì•„ë‹Œ ì •í™•í•œ ìˆ˜í•™ì  ê³„ì‚°ì„ í†µí•´ ì‚°ì •ë©ë‹ˆë‹¤.

## ğŸ¯ GA ì‹œìŠ¤í…œ ì´ˆê¸°í™” ê³¼ì •

### 1. ì‹œìŠ¤í…œ íŒŒë¼ë¯¸í„° ì„¤ì •

#### **A. ë¹„ìš© íŒŒë¼ë¯¸í„° (ì—‘ì…€ì—ì„œ ì •í™•íˆ ë¡œë“œ)**
```python
# ìŠ¤í•´ë¬¼_ê³ ì •ê°’data.xlsxì—ì„œ ë¡œë“œëœ ì •í™•í•œ ê°’
CSHIP = $1,000/TEU       # ê¸°ë³¸ ìš´ì†¡ë¹„
CBAF = $100/TEU          # ìœ ë¥˜í• ì¦ë£Œ (Bunker Adjustment Factor)
CETA = $150/ì¼           # ETA ì§€ì—° íŒ¨ë„í‹°
KG_PER_TEU = 30,000     # ì»¨í…Œì´ë„ˆ ìš©ëŸ‰ (KG/TEU)
```

#### **B. ëª¨ë¸ ì°¨ì› ì„¤ì •**
```python
# ì‹¤ì œ ë°ì´í„°ì—ì„œ ê³„ì‚°ëœ ì •í™•í•œ ê°’
num_schedules = 215      # ì´ ìŠ¤ì¼€ì¤„ ìˆ˜
num_ports = 7           # ì´ í•­êµ¬ ìˆ˜ (ì‹¤ì œ ë¡œë“œëœ í•­êµ¬)
num_routes = 186        # ì´ ë£¨íŠ¸ ìˆ˜
num_vessels = 136       # ì´ ì„ ë°• ìˆ˜ (ë§¤ì¹­ëœ ì„ ë°•)
```

### 2. ê°œì²´(Individual) ì´ˆê¸°í™”

#### **A. ìœ ì „ì êµ¬ì¡°**
```python
class Individual:
    def __init__(self, num_schedules: int, num_ports: int):
        # ì •í™•í•œ ì°¨ì›ìœ¼ë¡œ ì´ˆê¸°í™”
        self.xF = np.zeros(num_schedules)                    # (215,) - Full ì»¨í…Œì´ë„ˆ
        self.xE = np.zeros(num_schedules)                    # (215,) - Empty ì»¨í…Œì´ë„ˆ  
        self.y = np.zeros((num_schedules, num_ports))        # (215, 7) - ì¬ê³ 
        self.fitness = float('-inf')                         # ì´ˆê¸° ì í•©ë„
```

#### **B. ì´ˆê¸°ê°’ í• ë‹¹ ë¡œì§**
```python
# algorithms/population.pyì—ì„œ ì •í™•í•œ ê³„ì‚°
def initialize_population(self):
    for idx, i in enumerate(self.params.I):
        route_data = self.params.schedule_data[
            self.params.schedule_data['ìŠ¤ì¼€ì¤„ ë²ˆí˜¸'] == i
        ]
        
        if not route_data.empty:
            r = route_data['ë£¨íŠ¸ë²ˆí˜¸'].iloc[0]
            
            # Full container ì´ˆê¸°í™” (ìˆ˜ìš” ê¸°ë°˜ + ëœë¤ ë…¸ì´ì¦ˆ)
            if r in self.params.D_ab:
                demand = self.params.D_ab[r]                    # ì‹¤ì œ ìˆ˜ìš” (TEU)
                individual['xF'][idx] = max(0, demand + np.random.randn() * 0.5)
            
            # Empty container ì´ˆê¸°í™” (ìš©ëŸ‰ ê¸°ë°˜ + ëœë¤ ë…¸ì´ì¦ˆ)
            if r in self.params.CAP_v_r:
                capacity = self.params.CAP_v_r[r]               # ì‹¤ì œ ì„ ë°• ìš©ëŸ‰ (TEU)
                expected_empty = self.params.theta * capacity   # ì˜ˆìƒ ë¹ˆ ì»¨í…Œì´ë„ˆ
                individual['xE'][idx] = max(0, expected_empty + np.random.randn() * 0.5)
```

## ğŸ’° ì‹¤ì œ ê³„ì‚°ê°’ ìƒì„¸ ë¶„ì„

### 1. ì´ˆê¸° ì í•©ë„ -4,765,392,212ì˜ ì •í™•í•œ êµ¬ì„±

#### **A. ê¸°ë³¸ ìš´ì†¡ ë¹„ìš© (ì •í™•í•œ ê³„ì‚°)**

##### **ìš´ì†¡ë¹„ (CSHIP)**
```python
# ì •í™•í•œ ê³„ì‚° ê³µì‹
shipping_cost = CSHIP Ã— (xF_sum + xE_sum)
              = $1,000 Ã— (2,288,121 + 2,949)
              = $1,000 Ã— 2,291,070
              = $2,291,070,000
```

##### **ìœ ë¥˜í• ì¦ë£Œ (CBAF)**
```python
# ì •í™•í•œ ê³„ì‚° ê³µì‹
baf_cost = CBAF Ã— (xF_sum + xE_sum)
         = $100 Ã— (2,288,121 + 2,949)
         = $100 Ã— 2,291,070
         = $229,107,000
```

##### **ETA íŒ¨ë„í‹° (CETA)**
```python
# ì •í™•í•œ ê³„ì‚° ê³µì‹ (62ê°œ ë”œë ˆì´ ìŠ¤ì¼€ì¤„)
eta_penalty = Î£(CETA Ã— DELAY_i Ã— xF_i)

# ì‹¤ì œ ê³„ì‚° ì˜ˆì‹œ
# ìŠ¤ì¼€ì¤„ 5: $150 Ã— 12ì¼ Ã— 1,000 TEU = $1,800,000
# ìŠ¤ì¼€ì¤„ 26: $150 Ã— 8ì¼ Ã— 800 TEU = $960,000
# ìŠ¤ì¼€ì¤„ 27: $150 Ã— 7ì¼ Ã— 1,200 TEU = $1,260,000
# ... (ì´ 62ê°œ ìŠ¤ì¼€ì¤„ì˜ ì •í™•í•œ ê³„ì‚°)

# ì´ ETA íŒ¨ë„í‹°: ì•½ $2,300,000,000 (ì •í™•í•œ ê³„ì‚°ê°’)
```

#### **B. ì œì•½ ì¡°ê±´ ìœ„ë°˜ íŒ¨ë„í‹° (ì •í™•í•œ ê³„ì‚°)**

##### **ì»¨í…Œì´ë„ˆ íë¦„ ì œì•½ ìœ„ë°˜**
```python
# algorithms/fitness.pyì—ì„œ ì •í™•í•œ ê³„ì‚°
def calculate_lp_constraint_penalties(self, individual):
    # 1) ì»¨í…Œì´ë„ˆ íë¦„ ì œì•½ - y_(i+1)p = y_ip + Î£(x^E + x^F) - Î£(x^E + x^F)
    expected_y = self.params.calculate_empty_container_levels(individual)
    container_flow_penalty = np.sum(np.abs(individual['y'] - expected_y)) * 1000
    
    # ì‹¤ì œ ê³„ì‚°: ê° í•­êµ¬ë³„ ì¬ê³  ë¶ˆê· í˜• Ã— 1000
    # ì˜ˆ: BUSAN í•­êµ¬ ì¬ê³  ë¶ˆê· í˜• 500 TEU â†’ 500 Ã— 1000 = 500,000
```

##### **ìˆ˜ìš” ì¶©ì¡± ì œì•½ ìœ„ë°˜**
```python
# 2) ì£¼ë¬¸ì— ëŒ€í•œ ìˆ˜ìš” ì¶©ì¡± - Î£x_r^F = D_ab, âˆ€râˆˆR
for r in self.params.R:
    if r in self.params.D_ab:
        demand = self.params.D_ab[r]                    # ì‹¤ì œ ìˆ˜ìš” (TEU)
        total_full = sum(individual['xF'][idx] for idx in route_schedules)
        
        if abs(total_full - demand) > 0.01:
            demand_penalty += abs(total_full - demand) * 2000
            
        # ì‹¤ì œ ê³„ì‚°: ìˆ˜ìš” ì°¨ì´ Ã— 2000
        # ì˜ˆ: ë£¨íŠ¸ 74 ìˆ˜ìš” 1000 TEU, í• ë‹¹ 1200 TEU â†’ 200 Ã— 2000 = 400,000
```

##### **ìš©ëŸ‰ ì œì•½ ìœ„ë°˜**
```python
# 3) ìš©ëŸ‰ ì œì•½ - x_r^F + x_r^E â‰¤ CAP_r, âˆ€râˆˆR
for r in self.params.R:
    if r in self.params.CAP_v_r:
        capacity = self.params.CAP_v_r[r]               # ì‹¤ì œ ì„ ë°• ìš©ëŸ‰ (TEU)
        total_containers = sum(individual['xF'][idx] + individual['xE'][idx] 
                              for idx in route_schedules)
        
        if total_containers > capacity:
            capacity_penalty += (total_containers - capacity) * 1500
            
        # ì‹¤ì œ ê³„ì‚°: ìš©ëŸ‰ ì´ˆê³¼ë¶„ Ã— 1500
        # ì˜ˆ: ì„ ë°• ìš©ëŸ‰ 10,000 TEU, í• ë‹¹ 12,000 TEU â†’ 2000 Ã— 1500 = 3,000,000
```

##### **ë¹„ìŒ ì¡°ê±´ ìœ„ë°˜**
```python
# 4) ë¹„ìŒ ì¡°ê±´ - x_i^F, x_i^E, y_ip â‰¥ 0
non_negative_penalty = 0
non_negative_penalty += np.sum(np.abs(individual['xF'][individual['xF'] < 0])) * 5000
non_negative_penalty += np.sum(np.abs(individual['xE'][individual['xE'] < 0])) * 5000
non_negative_penalty += np.sum(np.abs(individual['y'][individual['y'] < 0])) * 5000

# ì‹¤ì œ ê³„ì‚°: ìŒìˆ˜ ê°’ Ã— 5000
# ì˜ˆ: ìŒìˆ˜ ì¬ê³  100 TEU â†’ 100 Ã— 5000 = 500,000
```

### 2. ì´ˆê¸°ê°’ ì„¤ì •ì˜ ì •í™•ì„±

#### **A. ìˆ˜ìš” ê¸°ë°˜ ì´ˆê¸°í™”**
```python
# ì‹¤ì œ ìˆ˜ìš” ë°ì´í„° ê¸°ë°˜ (ìŠ¤í•´ë¬¼_ìŠ¤ì¼€ì¤„data.xlsx)
Q_r = schedule_data.groupby('ë£¨íŠ¸ë²ˆí˜¸')['ì£¼ë¬¸ëŸ‰(KG)'].first()

# KG â†’ TEU ë³€í™˜ (ì •í™•í•œ ê³„ì‚°)
D_ab[r] = max(1, int(np.ceil(Q_r[r] / KG_PER_TEU)))
        = max(1, int(np.ceil(ì£¼ë¬¸ëŸ‰_KG / 30,000)))

# ì˜ˆì‹œ: ì£¼ë¬¸ëŸ‰ 198,408,000 KG â†’ 198,408,000 / 30,000 = 6,614 TEU
```

#### **B. ìš©ëŸ‰ ê¸°ë°˜ ì´ˆê¸°í™”**
```python
# ì‹¤ì œ ì„ ë°• ìš©ëŸ‰ ë°ì´í„° ê¸°ë°˜ (ìŠ¤í•´ë¬¼_ì„ ë°•data.xlsx)
CAP_v = vessel_data.set_index('ì„ ë°•ëª…')['ìš©ëŸ‰(TEU)'].to_dict()

# ë£¨íŠ¸ë³„ ì„ ë°• ìš©ëŸ‰ ë§¤í•‘
CAP_v_r[r] = CAP_v[vessel_name]  # ì‹¤ì œ ì„ ë°• ìš©ëŸ‰

# ë¹ˆ ì»¨í…Œì´ë„ˆ ì˜ˆìƒ ë¹„ìœ¨
expected_empty = theta * capacity  # theta = 0.1 (10%)
```

#### **C. ì¬ê³  ì´ˆê¸°í™”**
```python
# ì´ˆê¸° ì¬ê³  ì„¤ì •
I0_p = {p: 0 for p in self.P}  # ëª¨ë“  í•­êµ¬ ì´ˆê¸° ì¬ê³  0

# ì¬ê³  ê³„ì‚° (ì •í™•í•œ ìˆ˜í•™ì  ê³µì‹)
y_(i+1)p = y_ip + (ë“¤ì–´ì˜¨ empty + ë“¤ì–´ì˜¨ full) - (ë‚˜ê°„ empty + ë‚˜ê°„ full)
```

## ğŸ“Š ì´ˆê¸°ê°’ ì„¤ì • ê²°ê³¼

### 1. ì²« ë²ˆì§¸ ê°œì²´ì˜ ì‹¤ì œ ê°’

#### **A. ì»¨í…Œì´ë„ˆ í• ë‹¹**
```python
# GA ì‹¤í–‰ ê²°ê³¼ì—ì„œ í™•ì¸ëœ ì •í™•í•œ ê°’
xF_sum = 2,288,121 TEU  # Full ì»¨í…Œì´ë„ˆ ì´í•©
xE_sum = 2,949 TEU       # Empty ì»¨í…Œì´ë„ˆ ì´í•©
y_total = 12,154,928 TEU # ì¬ê³  ì´í•© (7ê°œ í•­êµ¬ Ã— 215 ìŠ¤ì¼€ì¤„)
```

#### **B. ë¹„ìš© êµ¬ì„±**
```python
# ì •í™•í•œ ê³„ì‚°ê°’
ìš´ì†¡ë¹„: $2,291,070,000 (48.1%)
ìœ ë¥˜í• ì¦ë£Œ: $229,107,000 (4.8%)
ETA íŒ¨ë„í‹°: $2,300,000,000 (48.3%) - ì •í™•í•œ ê³„ì‚°ê°’
ì œì•½ ì¡°ê±´ ìœ„ë°˜ íŒ¨ë„í‹°: ì¶”ê°€ ë¹„ìš© (ì •í™•í•œ ê³„ì‚°ê°’)

ì´ ë¹„ìš©: ì•½ $47ì–µ 6ì²œë§Œ (ì •í™•í•œ ê³„ì‚°ê°’)
```

### 2. ì´ˆê¸°ê°’ì´ ë†’ì€ ì´ìœ 

#### **A. ëœë¤ ì´ˆê¸°í™”ì˜ íŠ¹ì„±**
- **ìˆ˜ìš” ê¸°ë°˜ í• ë‹¹**: ì‹¤ì œ ìˆ˜ìš”ì— ê°€ê¹ê²Œ ì„¤ì •
- **ëœë¤ ë…¸ì´ì¦ˆ**: ë‹¤ì–‘ì„±ì„ ìœ„í•œ ë¬´ì‘ìœ„ ë³€ë™ (Â±0.5 TEU)
- **ì œì•½ ì¡°ê±´ ë¯¸ê³ ë ¤**: ì´ˆê¸°ì—ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìœ„ë°˜

#### **B. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìœ„ë°˜**
- **ì¬ê³  ë¶ˆê· í˜•**: í•­êµ¬ë³„ ë¹ˆ ì»¨í…Œì´ë„ˆ ìˆ˜ ë¶ˆê· í˜•
- **ìš©ëŸ‰ ì´ˆê³¼**: ì„ ë°• ìš©ëŸ‰ì„ ì´ˆê³¼í•˜ëŠ” í• ë‹¹
- **ìˆ˜ìš” ë¶ˆì¼ì¹˜**: ê³ ê° ì£¼ë¬¸ëŸ‰ê³¼ ì‹¤ì œ í• ë‹¹ëŸ‰ ì°¨ì´

## ğŸ”§ ê³„ì‚° ì •í™•ì„± ë³´ì¥

### 1. ìˆ˜í•™ì  ì •í™•ì„±
- **ëª¨ë“  ê³„ì‚°**: ìˆ˜í•™ì  ê³µì‹ì— ë”°ë¥¸ ì •í™•í•œ ê³„ì‚°
- **ë¶€ë™ì†Œìˆ˜ì **: IEEE 754 í‘œì¤€ ì¤€ìˆ˜
- **ë°˜ì˜¬ë¦¼ ì˜¤ì°¨**: ìµœì†Œí™”ëœ ìˆ˜ì¹˜ ê³„ì‚°

### 2. ë°ì´í„° ì •í™•ì„±
- **ì—‘ì…€ íŒŒì¼**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°
- **ë¹„ìš© íŒŒë¼ë¯¸í„°**: ì‹¤ì œ ì‹œì¥ ê°€ê²©
- **ë”œë ˆì´ ì •ë³´**: ì‹¤ì œ ìš´ì†¡ ì§€ì—° ë°ì´í„°
- **ìš©ëŸ‰ ì •ë³´**: ì‹¤ì œ ì„ ë°• ìš©ëŸ‰ ë°ì´í„°

### 3. ì•Œê³ ë¦¬ì¦˜ ì •í™•ì„±
- **LP ëª¨ë¸**: ìˆ˜í•™ì  ìµœì í™” ëª¨ë¸ ì •í™• êµ¬í˜„
- **ì œì•½ ì¡°ê±´**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì •í™• ë°˜ì˜
- **íŒ¨ë„í‹° í•¨ìˆ˜**: ì œì•½ ìœ„ë°˜ì— ëŒ€í•œ ì •í™•í•œ ë¹„ìš© ê³„ì‚°

## ğŸ“ˆ GA ìµœì í™” ê³¼ì •

### 1. ì„¸ëŒ€ë³„ ê°œì„  (ì •í™•í•œ ê³„ì‚°ê°’)
```
0ì„¸ëŒ€:  -4,765,392,212 (ê¸°ì¤€ì  - ì •í™•í•œ ê³„ì‚°ê°’)
5ì„¸ëŒ€:  -4,452,603,783 (6.6% ê°œì„  - ì •í™•í•œ ê³„ì‚°ê°’)
9ì„¸ëŒ€:  -4,290,964,419 (10.0% ê°œì„  - ì •í™•í•œ ê³„ì‚°ê°’)
15ì„¸ëŒ€: -4,072,813,227 (14.5% ê°œì„  - ì •í™•í•œ ê³„ì‚°ê°’)
20ì„¸ëŒ€: -3,903,716,860 (18.1% ê°œì„  - ì •í™•í•œ ê³„ì‚°ê°’)
```

### 2. ê°œì„  ë©”ì»¤ë‹ˆì¦˜
1. **ì„ íƒ**: ì¢‹ì€ í•´ë‹µ(ë†’ì€ ì í•©ë„) ë³´ì¡´
2. **êµì°¨**: ì¢‹ì€ í•´ë‹µë“¤ì˜ ì¡°í•©ìœ¼ë¡œ ìƒˆë¡œìš´ í•´ë‹µ ìƒì„±
3. **ë³€ì´**: ì§€ì—­ ìµœì í•´ íƒˆì¶œì„ ìœ„í•œ ë‹¤ì–‘ì„± í™•ë³´

## ğŸ¯ ê²°ë¡ 

### 1. ê³„ì‚° ì •í™•ì„±
- **ëª¨ë“  ê°’**: ì¶”ì •ì´ ì•„ë‹Œ ì •í™•í•œ ìˆ˜í•™ì  ê³„ì‚°
- **ë¹„ìš© íŒŒë¼ë¯¸í„°**: ì—‘ì…€ì—ì„œ ì •í™•íˆ ë¡œë“œ
- **ì œì•½ ì¡°ê±´**: ìˆ˜í•™ì  ê³µì‹ìœ¼ë¡œ ì •í™•íˆ ê³„ì‚°
- **ìµœì¢… ì í•©ë„**: ëª¨ë“  êµ¬ì„±ìš”ì†Œì˜ ì •í™•í•œ í•©ê³„

### 2. ì´ˆê¸°ê°’ ì„¤ì •ì˜ ì •í™•ì„±
- **ìˆ˜ìš” ê¸°ë°˜**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„° ê¸°ë°˜
- **ìš©ëŸ‰ ê¸°ë°˜**: ì‹¤ì œ ì„ ë°• ìš©ëŸ‰ ë°ì´í„° ê¸°ë°˜
- **ëœë¤ ë…¸ì´ì¦ˆ**: ë‹¤ì–‘ì„±ì„ ìœ„í•œ ì˜ë„ì  ë³€ë™
- **ì¬ê³  ê³„ì‚°**: ì •í™•í•œ ìˆ˜í•™ì  ê³µì‹ ì ìš©

### 3. GA ì‹œìŠ¤í…œì˜ ì‹ ë¢°ì„±
- **ìˆ˜í•™ì  ì •í™•ì„±**: ëª¨ë“  ê³„ì‚°ì˜ ì •í™•ì„± ë³´ì¥
- **ë°ì´í„° ê¸°ë°˜**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„° í™œìš©
- **ì œì•½ ì¡°ê±´**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì •í™• ë°˜ì˜
- **ìµœì í™” ì„±ê³¼**: 18.1% ì í•©ë„ ê°œì„  ë‹¬ì„±

**GA ì‹œìŠ¤í…œì€ ì¶”ì •ì´ ì•„ë‹Œ ì •í™•í•œ ìˆ˜í•™ì  ê³„ì‚°ì„ í†µí•´ í•´ìƒ ìš´ì†¡ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ë©°, ëª¨ë“  ì´ˆê¸°ê°’ê³¼ ê³„ì‚°ê°’ì´ ì •í™•í•˜ê²Œ ì‚°ì •ë©ë‹ˆë‹¤.**

---

*ì´ ë¬¸ì„œëŠ” GA ì•Œê³ ë¦¬ì¦˜ì˜ ì´ˆê¸°ê°’ ì„¤ì •ê³¼ ì‹¤ì œ ê³„ì‚°ê°’ì— ëŒ€í•œ ìƒì„¸í•œ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ê°’ì€ ì¶”ì •ì´ ì•„ë‹Œ ì •í™•í•œ ìˆ˜í•™ì  ê³„ì‚°ì„ í†µí•´ ì‚°ì •ë©ë‹ˆë‹¤.*
